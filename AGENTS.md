# AGENTS.md: Firewall Manager 개발 가이드

## 1. 프로젝트 개요

이 프로젝트의 목표는 여러 방화벽 장비를 중앙에서 관리하고 분석할 수 있는 웹 기반 애플리케이션을 구축하는 것입니다. 사용자는 대시보드를 통해 장비 상태를 한눈에 파악하고, 정책을 분석하며, 정의된 시나리오에 따라 문제를 해결할 수 있습니다. 이 애플리케이션은 폐쇄망 환경에서 동작하는 것을 전제로 합니다.

## 2. 핵심 기능

### 2.1. 대시보드
- **목표:** 모든 등록된 장비의 상태를 요약하고 시각화하여 제공합니다.
- **세부 기능:**
    - 장비별 CPU, 메모리, 세션 사용률 등 주요 지표를 차트로 시각화합니다.
    - 비정상 상태(예: 높은 리소스 사용률, 연결 실패)가 감지된 장비 목록을 표시합니다.
    - 문제가 감지되면, 관련 점검 시나리오나 해결 방안을 제안합니다.

### 2.2. 장비 관리
- **목표:** 방화벽 장비의 연결 정보를 관리하고 상세 상태를 조회합니다.
- **세부 기능:**
    - 장비 정보(이름, IP, 벤더, 자격 증명)를 등록, 수정, 삭제하는 CRUD 인터페이스를 제공합니다.
    - 특정 장비를 선택하여 실시간 상태 정보 및 기본 정보를 상세히 조회할 수 있습니다.

### 2.3. 정책 관리
- **목표:** 수집된 방화벽 정책을 저장하고, 사용자가 쉽게 검색하고 분석할 수 있도록 지원합니다.
- **세부 기능:**
    - 방화벽에서 수집된 정책 데이터를 SQLite 데이터베이스에 저장합니다.
    - 출발지, 목적지, 서비스, 액션 등 가공된 데이터를 기반으로 정책을 필터링하고 검색하는 기능을 제공합니다.
    - **중요:** 정책을 직접 생성하거나 방화벽에 배포/적용하는 기능은 **구현하지 않습니다.** 대신, 분석 결과를 바탕으로 정책 변경을 '제안'하는 텍스트나 리포트를 생성할 수 있습니다.

### 2.4. 시나리오 기능
- **목표:** 반복적인 점검 및 트러블슈팅 절차를 시나리오로 정의하고 실행할 수 있도록 지원합니다.
- **세부 기능:**
    - '장비 헬스 체크', '특정 서비스 장애 분석' 등과 같은 점검 항목과 순서를 시나리오로 정의합니다.
    - 사용자는 시나리오를 선택하여 순서대로 점검을 진행하며, 각 단계의 결과를 메모로 남기거나, 간단한 자동화 스크립트(예: 연결 테스트)를 실행할 수 있습니다.

## 3. 기술 스택

- **환경:** **폐쇄망(Offline)** 환경을 전제로 합니다. 외부 CDN 사용을 지양하고, 모든 라이브러리는 로컬에 포함해야 합니다.
- **백엔드:** **FastAPI**
- **프론트엔드:**
    - **HTML / CSS / JavaScript (Vanilla JS)**
    - **CSS 프레임워크:** **Bulma**
    - **테이블/그리드:** **AG-Grid**
    - **차트:** **ApexCharts.js**
- **데이터베이스:** **SQLite**

## 4. 아키텍처 및 개발 가이드라인

### 백엔드 (FastAPI)
- 현재 구축된 `firewall_manager`의 구조(`api`, `crud`, `models`, `schemas`)를 계속 유지하고 확장합니다.
- 모든 비즈니스 로직은 `crud` 또는 별도의 `services` 레이어에 구현하고, `api` 엔드포인트는 데이터 입출력과 흐름 제어에 집중합니다.
- 데이터베이스 스키마(`models`) 변경 시, 반드시 `alembic`을 사용하여 마이그레이션 스크립트를 생성하고 관리합니다.

### 프론트엔드 (Vanilla JS + Bulma)
- 프론트엔드 관련 파일(HTML, CSS, JS)은 `firewall_manager/static` 디렉토리 내에 생성합니다.
- `index.html`을 기본 진입점으로 하는 SPA(Single Page Application) 형태로 구성합니다.
- 페이지 내용은 JavaScript를 사용하여 동적으로 렌더링하며, 백엔드 API와는 `fetch` API를 통해 비동기적으로 통신합니다.
- AG-Grid와 ApexCharts.js는 문서를 참고하여 데이터를 시각화하는 데 적극적으로 활용합니다.

### 보안
- 사용자의 비밀번호와 같은 민감한 정보는 데이터베이스에 저장하기 전에 반드시 **해싱(Hashing)** 처리해야 합니다. 현재는 평문으로 저장되어 있으나, 향후 `passlib` 등의 라이브러리를 도입하여 보안을 강화해야 합니다.

---
*이 문서는 프로젝트의 요구사항과 방향을 정의하는 중요한 문서입니다. 모든 개발 작업은 이 문서의 내용을 기반으로 진행되어야 합니다.*